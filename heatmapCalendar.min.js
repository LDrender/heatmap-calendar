var heatmapCalendar=function(){"use strict";class e{constructor(){e.prototype.config={style:{type:"dark",cellSize:20,cellRadius:3,cellGap:4,cellColor_level_0:"rgba(110, 118, 129, 25%)",cellColor_level_1:"#0e4429",cellColor_level_2:"#006d32",cellColor_level_3:"#26a641",cellColor_level_4:"#39d353"},language:"en-US",container:"#heatmap-cal",nbrDisplayMonth:12,days:7,month:12,currentDate:new Date().toLocaleDateString("en-US").slice(0,10),display:"auto",title:"Calendar Heatmap",toolTip:{show:!0,text:"Heat value",textPostion:"after",separator:"-"},legend:{show:!0,align:"right",minLabel:"less",maxLabel:"more",toolTip:"auto",toolTip_default:[0,1,2,3,4],toolTip_value:[0,1,2,3,4]},getOptions:this.getOptions,calculateToolTip:this.calculateToolTip,bissextile:this.bissextile,calculateDateParameters:this.calculateDateParameters}}setOptions(e){let t=!1;for(let a in e)if("object"==typeof e[a]&&"data"!==a)for(let l in e[a])t=this.setSubOption(a,l,e[a][l])||t;else this.setOption(a,e[a])&&(t=!0);return t}setOption(e,t){return this.config[e]!=t&&(this.config[e]=typeof t==typeof this.config[e]?t:this.config[e],!0)}setSubOption(e,t,a){return this.config[e][t]!=a&&(this.config[e][t]=typeof a==typeof this.config[e][t]?a:this.config[e][t],!0)}getOptions(){return this.config}calculateToolTip(e){let t=[],a=0;for(let l=0;l<e.length;l++){let s=parseInt(e[l].value);s>a&&(a=s)}if("auto"===this.config.legend.toolTip){if(a>=5){for(let n=0;n<this.config.legend.toolTip_value.length;n++)t.push(Math.round(a*this.config.legend.toolTip_value[n]/5));t[1]=1}else t=this.config.legend.toolTip_default}else"fixed"===this.config.legend.toolTip&&(t=this.config.legend.toolTip_value);return t}bissextile(){let e=new Date().getFullYear();return e%4==0&&e%100!=0||e%400==0?366:365}calculateDateParameters(){let e=new Date,t=12===this.month?e.getMonth():this.month,a=e.getFullYear(),l=null,s=0;if("year"===this.display)l=new Date(a,0,0),s=this.bissextile();else if(12===this.nbrDisplayMonth)"month"===this.display?(l=new Date(a,t,0),s=new Date(a,t+1,0).getDate()):(l=new Date(new Date().setDate(e.getDate()-this.bissextile())),s=this.bissextile());else{"month"===this.display&&(e=new Date(e.setDate(new Date(a,t+1,0).getDate())));let n=e.getMonth()-(this.nbrDisplayMonth-1),i=e.getFullYear();n<0&&(i--,n=11+n);let o=new Date(i,n,0);t="month"===this.display?o.getMonth()+2:o.getMonth()+1,a=o.getFullYear();for(let r=0;r<this.nbrDisplayMonth;r++)t>11&&(t=0,a++),s+=new Date(new Date().getFullYear(),t,0).getDate(),console.log(new Date(new Date().getFullYear(),t,0),new Date(new Date().getFullYear(),t,0).getDate()),t++;l=new Date(e.setDate(e.getDate()-s))}return{nbrDays:s,startDate:l}}}return class t{constructor(t,a){this.options=new e(t),this.calendar=new class t extends e{drawContainer(){let e=document.createElement("div");if(e.classList.add("calendar-heatmap"),"dark"===super.config.style.type&&e.classList.add("dark"),e.style.cssText+=`--cell-size: ${super.config.style.cellSize}px`,e.style.cssText+=`--cell-radius: ${super.config.style.cellRadius}px`,e.style.cssText+=`--cell-gap: ${super.config.style.cellGap}px`,e.style.cssText+=`--color-data-level-0: ${super.config.style.cellColor_level_0}`,e.style.cssText+=`--color-data-level-1: ${super.config.style.cellColor_level_1}`,e.style.cssText+=`--color-data-level-2: ${super.config.style.cellColor_level_2}`,e.style.cssText+=`--color-data-level-3: ${super.config.style.cellColor_level_3}`,e.style.cssText+=`--color-data-level-4: ${super.config.style.cellColor_level_4}`,document.querySelector(super.config.container).appendChild(e),super.config.title&&""!==super.config.title&&null!==super.config.title){let t=document.createElement("h2");t.classList.add("calendar-heatmap-title"),t.textContent=super.config.title,e.appendChild(t)}let a=document.createElement("div");a.classList.add("calendar-heatmap-content-container"),e.appendChild(a);let l=document.createElement("div");l.classList.add("calendar-heatmap-month"),a.appendChild(l);let s=document.createElement("div");if(s.classList.add("calendar-heatmap-date-container"),a.appendChild(s),super.config.legend.show){let n=document.createElement("div");n.classList.add("calendar-heatmap-legend"),n.classList.add(`calendar-heatmap-legend-position-${super.config.legend.align}`),e.appendChild(n),this.drawLegende(n)}this.drawCalendarData(s,l)}drawCalendarData(e,t){let a=super.config.calculateDateParameters(),l=super.config.legend.toolTip_value,s=new Date(a.startDate.setDate(a.startDate.getDate())),n=0;for(;n<=a.nbrDays;){let i=document.createElement("div");i.classList.add("calendar-heatmap-column");for(let o=0;o<super.config.days&&!(++n>a.nbrDays);o++){let r=document.createElement("span");r.classList.add("calendar-heatmap-day");let c=new Date(a.startDate.setDate(a.startDate.getDate()+1)),d=c.toLocaleDateString().slice(0,10);r.dataset.date=d,c.toLocaleDateString("en-US")===super.config.currentDate&&r.classList.add("current"),super.config.data&&super.config.data.forEach(e=>{let t=new Date(e.date);t.toLocaleDateString("en-US")===c.toLocaleDateString("en-US")?r.dataset.value=e.value:r.dataset.value||(r.dataset.value=0)}),r.dataset.value>=l[0]&&r.dataset.value<l[1]?r.dataset.level=0:r.dataset.value>=l[1]&&r.dataset.value<l[2]?r.dataset.level=1:r.dataset.value>=l[2]&&r.dataset.value<l[3]?r.dataset.level=2:r.dataset.value>=l[3]&&r.dataset.value<l[4]?r.dataset.level=3:r.dataset.value>=l[4]&&(r.dataset.level=4),super.config.toolTip.show&&("after"===super.config.toolTip.textPostion?r.dataset.tooltip=`${r.dataset.value} ${super.config.toolTip.text} ${super.config.toolTip.separator} ${d}`:r.dataset.tooltip=`${super.config.toolTip.text} ${r.dataset.value} ${super.config.toolTip.separator} ${d}`),i.appendChild(r)}e.appendChild(i)}let p=s.getDate(),g=s.getMonth(),u=super.config.nbrDisplayMonth;"month"===super.config.display?u=12===u?1:u:"year"===super.config.display&&(u=12),p>15&&g++;for(let h=0;h<u;h++){let f=document.createElement("span"),m=new Date(new Date().setMonth(g));f.classList.add("calendar-heatmap-month-name"),f.textContent=m.toLocaleDateString(super.config.language,{month:"short"}),t.appendChild(f),g++}}drawLegende(e){if(super.config.legend.minLabel){let t=document.createElement("span");t.classList.add("calendar-heatmap-legend-min-label"),t.textContent=super.config.legend.minLabel,e.appendChild(t)}let a=super.config.legend.toolTip_value;if(a.forEach((t,a)=>{let l=document.createElement("span");l.classList.add("calendar-heatmap-day"),l.dataset.level=a,"hidden"!==super.config.legend.toolTip&&(l.dataset.tooltip=t),e.appendChild(l)}),super.config.legend.maxLabel){let l=document.createElement("span");l.classList.add("calendar-heatmap-legend-max-label"),l.textContent=super.config.legend.maxLabel,e.appendChild(l)}}},this.init(t,a)}init(e,t){return e&&this.options.setOptions(e),this.options.config.data="object"==typeof t?t:this.options.config.data,"auto"===this.options.config.legend.toolTip&&t&&(this.options.config.legend.toolTip_value=this.options.calculateToolTip(this.options.config.data)),this.calendar.drawContainer(),!0}}}();