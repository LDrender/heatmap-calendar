var heatmapCalendar=function(){"use strict";class e{constructor(){e.prototype.config={style:{type:"dark",cellSize:20,cellRadius:3,cellGap:4,cellColor_level_0:"rgba(110, 118, 129, 25%)",cellColor_level_1:"#0e4429",cellColor_level_2:"#006d32",cellColor_level_3:"#26a641",cellColor_level_4:"#39d353"},language:"en-US",container:"#heatmap-cal",nbrDisplayMonth:12,days:7,month:12,currentDate:(new Date).toLocaleDateString("en-US").slice(0,10),display:"auto",title:"Calendar Heatmap",toolTip:{show:!0,text:"Heat value",textPostion:"after",separator:"-"},legend:{show:!0,align:"right",minLabel:"less",maxLabel:"more",toolTip:"auto",toolTip_default:[0,1,2,3,4],toolTip_value:[0,1,2,3,4]},getOptions:this.getOptions,calculateToolTip:this.calculateToolTip,bissextile:this.bissextile,calculateDateParameters:this.calculateDateParameters}}setOptions(e){let t=!1;for(let a in e)if("object"==typeof e[a]&&"data"!==a)for(let l in e[a])t=this.setSubOption(a,l,e[a][l])||t;else this.setOption(a,e[a])&&(t=!0);return t}setOption(e,t){return this.config[e]!=t&&(this.config[e]=typeof t==typeof this.config[e]?t:this.config[e],!0)}setSubOption(e,t,a){return this.config[e][t]!=a&&(this.config[e][t]=typeof a==typeof this.config[e][t]?a:this.config[e][t],!0)}getOptions(){return this.config}calculateToolTip(e){let t=[],a=0;for(let t=0;t<e.length;t++){let l=parseInt(e[t].value);l>a&&(a=l)}if("auto"===this.config.legend.toolTip)if(a>=5){for(let e=0;e<this.config.legend.toolTip_value.length;e++)t.push(Math.round(a*this.config.legend.toolTip_value[e]/5));t[1]=1}else t=this.config.legend.toolTip_default;else"fixed"===this.config.legend.toolTip&&(t=this.config.legend.toolTip_value);return t}bissextile(){const e=(new Date).getFullYear();return e%4==0&&e%100!=0||e%400==0?366:365}calculateDateParameters(){let e=new Date,t=12===this.month?e.getMonth():this.month,a=e.getFullYear(),l=null,s=0;if("year"===this.display)l=new Date(a,0,0),s=this.bissextile();else if(12===this.nbrDisplayMonth)"month"===this.display?(l=new Date(a,t,0),s=new Date(a,t+1,0).getDate()):(l=new Date((new Date).setDate(e.getDate()-this.bissextile())),s=this.bissextile());else{"month"===this.display&&(e=new Date(e.setDate(new Date(a,t+1,0).getDate())));let n=e.getMonth()-(this.nbrDisplayMonth-1),o=e.getFullYear();n<0&&(o--,n=11+n);let i=new Date(o,n,0);t="month"===this.display?i.getMonth()+2:i.getMonth()+1,a=i.getFullYear();for(let e=0;e<this.nbrDisplayMonth;e++)t>11&&(t=0,a++),s+=new Date((new Date).getFullYear(),t,0).getDate(),t++;l=new Date(e.setDate(e.getDate()-s))}if("auto"===this.display){let t=document.querySelector(this.container).clientWidth,a=Math.floor(s/this.days),n=this.style.cellSize+this.style.cellGap+2,o=n*a;if(o>t){let i=0;for(;o>t;)i++,o=n*(a-i);i++,s-=i*this.days,l=new Date(e.setDate(e.getDate()-s))}}return{nbrDays:s,startDate:l}}}class t extends e{drawContainer(){const e=document.createElement("div");if(e.classList.add("calendar-heatmap"),"dark"===super.config.style.type&&e.classList.add("dark"),e.style.cssText+=`--cell-size: ${super.config.style.cellSize}px`,e.style.cssText+=`--cell-radius: ${super.config.style.cellRadius}px`,e.style.cssText+=`--cell-gap: ${super.config.style.cellGap}px`,e.style.cssText+=`--color-data-level-0: ${super.config.style.cellColor_level_0}`,e.style.cssText+=`--color-data-level-1: ${super.config.style.cellColor_level_1}`,e.style.cssText+=`--color-data-level-2: ${super.config.style.cellColor_level_2}`,e.style.cssText+=`--color-data-level-3: ${super.config.style.cellColor_level_3}`,e.style.cssText+=`--color-data-level-4: ${super.config.style.cellColor_level_4}`,document.querySelector(super.config.container).appendChild(e),super.config.title&&""!==super.config.title&&null!==super.config.title){const t=document.createElement("h2");t.classList.add("calendar-heatmap-title"),t.textContent=super.config.title,e.appendChild(t)}const t=document.createElement("div");t.classList.add("calendar-heatmap-content-container"),e.appendChild(t);const a=document.createElement("div");a.classList.add("calendar-heatmap-month"),t.appendChild(a);const l=document.createElement("div");if(l.classList.add("calendar-heatmap-date-container"),t.appendChild(l),super.config.legend.show){const t=document.createElement("div");t.classList.add("calendar-heatmap-legend"),t.classList.add(`calendar-heatmap-legend-position-${super.config.legend.align}`),e.appendChild(t),this.drawLegende(t)}this.drawCalendarData(l,a)}drawCalendarData(e,t){const a=super.config.calculateDateParameters(),l=super.config.legend.toolTip_value;new Date(a.startDate.setDate(a.startDate.getDate()));let s=0,n=[],o=null;for(;s<=a.nbrDays;){const t=document.createElement("div");t.classList.add("calendar-heatmap-column");for(let e=0;e<super.config.days&&(s++,!(s>a.nbrDays));e++){const e=document.createElement("span");e.classList.add("calendar-heatmap-day");const s=new Date(a.startDate.setDate(a.startDate.getDate()+1)),i=s.toLocaleDateString().slice(0,10);e.dataset.date=i;const c=s.getMonth();c!==o&&(o=c,n.push(s.toLocaleString(super.config.language,{month:"short"}))),s.toLocaleDateString("en-US")===super.config.currentDate&&e.classList.add("current"),super.config.data&&super.config.data.forEach((t=>{new Date(t.date).toLocaleDateString("en-US")===s.toLocaleDateString("en-US")?e.dataset.value=t.value:e.dataset.value||(e.dataset.value=0)})),e.dataset.value>=l[0]&&e.dataset.value<l[1]?e.dataset.level=0:e.dataset.value>=l[1]&&e.dataset.value<l[2]?e.dataset.level=1:e.dataset.value>=l[2]&&e.dataset.value<l[3]?e.dataset.level=2:e.dataset.value>=l[3]&&e.dataset.value<l[4]?e.dataset.level=3:e.dataset.value>=l[4]&&(e.dataset.level=4),super.config.toolTip.show&&("after"===super.config.toolTip.textPostion?e.dataset.tooltip=`${e.dataset.value} ${super.config.toolTip.text} ${super.config.toolTip.separator} ${i}`:e.dataset.tooltip=`${super.config.toolTip.text} ${e.dataset.value} ${super.config.toolTip.separator} ${i}`),t.appendChild(e)}e.appendChild(t)}for(let e=0;e<n.length;e++){const a=document.createElement("span");a.classList.add("calendar-heatmap-month-name"),a.textContent=n[e],t.appendChild(a)}}drawLegende(e){if(super.config.legend.minLabel){const t=document.createElement("span");t.classList.add("calendar-heatmap-legend-min-label"),t.textContent=super.config.legend.minLabel,e.appendChild(t)}if(super.config.legend.toolTip_value.forEach(((t,a)=>{const l=document.createElement("span");l.classList.add("calendar-heatmap-day"),l.dataset.level=a,"hidden"!==super.config.legend.toolTip&&(l.dataset.tooltip=t),e.appendChild(l)})),super.config.legend.maxLabel){const t=document.createElement("span");t.classList.add("calendar-heatmap-legend-max-label"),t.textContent=super.config.legend.maxLabel,e.appendChild(t)}}}return class{constructor(a,l){this.options=new e(a),this.calendar=new t,this.init(a,l)}init(e,t){return e&&this.options.setOptions(e),this.options.config.data="object"==typeof t?t:this.options.config.data,"auto"===this.options.config.legend.toolTip&&t&&(this.options.config.legend.toolTip_value=this.options.calculateToolTip(this.options.config.data)),this.calendar.drawContainer(),!0}}}();